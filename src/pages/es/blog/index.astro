---
import SiteLayout from "../../../layouts/SiteLayout.astro";
import ArticlesBlock from "@/components/blocks/articles-4.astro";
import EmptyState from "@/components/blocks/empty-state-1.astro";
import { getBlogPosts, getPage } from "@/lib/content";
import { renderMarkdown } from "@/lib/markdown";

const placeholderImage = "/uploads/image-placeholder.daj0efyq_29eycw.webp";

const posts = await getBlogPosts("es");
const page = await getPage('es', 'blog');
const fm = page.frontmatter as { title?: string; description?: string };
const items = posts.map((p) => ({
  title: p.title,
  description: p.description,
  href: `/es/blog/${p.slug}`,
  image: {
    src: p.image || placeholderImage,
    alt: p.title,
    width: 600,
    height: 338,
  },
  item: {},
}));
---

<SiteLayout
  lang="es"
  title={fm.title}
  description={fm.description}
>
  <ArticlesBlock items={items}>
    {fm.title && <h1>{fm.title}</h1>}
    {page.body && (
      <div class="contents" set:html={renderMarkdown(page.body)} />
    )}
  </ArticlesBlock>
  {items.length === 0 && (
    <EmptyState
      icon="file-plus-2"
      title="Aún no hay artículos"
      description="Estamos preparando contenido para el blog. Vuelve pronto."
    />
  )}
</SiteLayout>
