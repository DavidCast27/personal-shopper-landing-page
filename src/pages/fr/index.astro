---
import SiteLayout from "../../layouts/SiteLayout.astro";
import HeroBlock from "@/components/blocks/hero-3.astro";
import ServicesBlock from "@/components/blocks/services-7.astro";
import HowItWorks from "@/components/blocks/how-it-works-1.astro";
import CTABlock from "@/components/blocks/cta-8.astro";
import { getHome, getHowItWorks, getServices } from "@/lib/content";

const placeholderImage = "/uploads/image-placeholder.daj0efyq_29eycw.webp";

const home = await getHome("fr");
const steps = await getHowItWorks("fr");
const services = await getServices("fr");
// Home content is normalized in lib/content.ts
---

<SiteLayout
  lang="fr"
  title={home.title}
  description={home.description}
>
  <HeroBlock
    image={{
      src: home.hero_image || placeholderImage,
      alt: home.hero_image_alt,
      width: 256,
      height: 256,
    }}
    links={[
      {
        text: home.hero_cta_text,
        href: home.hero_cta_href,
      },
      { text: "En savoir plus", href: "/fr/services" },
    ]}
  >
    <h1>{home.hero_title}</h1>
    <p>
      {
        home.hero_subtitle
      }
    </p>
  </HeroBlock>
  <ServicesBlock
    items={services.map((service) => ({
      href: `/fr/services#${service.slug}`,
      title: service.title,
      description: service.description,
      image: {
        src: service.image || placeholderImage,
        alt: service.title,
        width: 256,
        height: 256,
      },
      links: [{ text: "En savoir plus", href: `/fr/services` }],
    }))}
  >
    <h2>Services</h2>
    <p>Découvrez notre offre adaptée à vos besoins.</p>
  </ServicesBlock>
  <HowItWorks
    title="Étapes simples pour commencer"
    items={steps.map((s) => ({
      title: s.title,
      description: s.description,
      link_text: s.link_text,
      link_href: s.link_href,
    }))}
  />
  <h2>FAQ</h2>
  <p>Réponses aux questions fréquentes.</p>
</SiteLayout>
<CTABlock
  item={{
    rating: 5,
    description: "Approuvé par nos clients",
    images: [
      { src: placeholderImage, alt: "" },
      { src: placeholderImage, alt: "" },
    ],
  }}
  links={[{ text: "Nous contacter", href: "/fr/contact" }]}
>
  <p>Prêt à améliorer votre style ?</p>
</CTABlock>
