---
import SiteLayout from "../../layouts/SiteLayout.astro";
import FAQBlock from "@/components/blocks/faqs-3.astro";
import EmptyState from "@/components/blocks/empty-state-1.astro";
import { getFaq, getPage } from "@/lib/content";
import { stripMarkdown } from "@/lib/markdown";
import { renderMarkdown } from "@/lib/markdown";

const items = (await getFaq("fr")).map((q) => ({
  title: q.question,
  description: stripMarkdown(q.body || ""),
}));
const page = await getPage('fr', 'faq');
const fm = page.frontmatter as { title?: string; description?: string };
---

<SiteLayout
  lang="fr"
  title={fm.title}
  description={fm.description}
>
  <FAQBlock items={items}>
    {fm.title && <h1>{fm.title}</h1>}
    {page.body && <div class="contents" set:html={renderMarkdown(page.body)} />}
  </FAQBlock>
  {items.length === 0 && (
    <EmptyState
      icon="help-circle"
      title="Aucune FAQ pour le moment"
      description="Nous rassemblons les questions fréquentes. Revenez bientôt."
    />
  )}
</SiteLayout>
